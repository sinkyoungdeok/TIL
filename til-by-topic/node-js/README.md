- [섹션 1: 소개](#섹션-1-소개)
  - [Node.js란 무엇인가](#nodejs란-무엇인가)
  - [Node.js 역할과 사용법 이해](#nodejs-역할과-사용법-이해)
  - [REPL 작업 vs 파일 사용](#repl-작업-vs-파일-사용)
- [섹션3: 기본 개념 이해](#섹션3-기본-개념-이해)
  - [웹 작동 방식](#웹-작동-방식)
  - [Node의 라이프사이클 및 이벤트 루프](#node의-라이프사이클-및-이벤트-루프)
  - [요청 본문 분석](#요청-본문-분석)
  - [이벤트 기반 코드 실행의 이해](#이벤트-기반-코드-실행의-이해)
  - [Node.js 백그라운드 확인](#nodejs-백그라운드-확인)

## 섹션 1: 소개

### Node.js란 무엇인가

Node js

- js 런타임.
- js의 다른 버전이 Node js 라고 할 수 있음. (js를 다른 환경에서 구현한 것)
- js를 서버에서 실행할 수 있도록 해주며, 어떤 기기에서도 실행할 수 있다.
- 핵심) 브라우저 밖에서도 실행할 수 있음

V8 엔진

- 개발자들이 엔진에 붙인 이름
- js코드나 node js  코드를 머신코드로 컴파일 해줌
- Nodejs는 V8엔진을 통해서 여러 기능을 가능하게 해준다. (브라우저 대신에 Node js 런타임에서 직접 실행되기 때문)

### Node.js 역할과 사용법 이해

node js

- 유틸리티 스크립트를 작성하는데 훌륭한 도구
- React, Vue 등의 언어또는 프레임워크에 필요한 모든 빌드 과정에 간접적으로 Nodejs를 사용한다.
- Node.js를 가장 흔히 활용하는 용도는 웹개발이나 서버사이드 코드이다. (서버를 운영하는데 사용)
- Node.js는 서버에서 작동하는 코드를 작성하기만 하는 것이 아니다. 서버 자체를 스스로 작성하게 됨 (이 점이 PHP와의 차이점)
    - PHP에서는 Apache나 Nginx와 같은 추가 툴이 있어 요청을 받아 PHP 코드를 실행해주는 반면에
    - Node.js는 둘 모두를 수행한다. (코드를 요청하고, 코드에서 원하는 작업을 수행)
- 비즈니스 로직을 운영하는 데 사용하기도 함.
    - 요청받은 데이터를 처리하고
    - 파일을 처리하고
    - DB를 활용하는 등
- 응답 사이드도 처리한다
    - 들어오는 요청만이 아니라
    - Node.js를 사용해 클라이언트에게 데이터를 회신한다
- Node.js의 큰 장점: 프론트에서 주로 사용하는 js를 사용한다.

### REPL 작업 vs 파일 사용

- 코드를 실행하는 두 가지 방법

repl

- read, eval, print, loop의 반복과정
- terminal에 node를 입력하면 repl를 사용하게 된다.

파일 사용

- repl 대체 가능
- 장점: 코드를 미리 작성해서 항상 실행할 수 있음

---

## 섹션3: 기본 개념 이해

### 웹 작동 방식

1. 유저가 웹 페이지를 방문
2. 브라우저에 URL 입력 
3. 브라우저가 도메인 이름 서버로 접근하여 해당 도메인을 찾음 
4. 브라우저는 전달받은 IP주소를 사용하여 해당 서버로 요청을 보냄
5. 그 이후부터가 Node js 역할인데 
6. Node js 등이 DB하고 소통을 함
7. 클라이언트로 응답을 다시 보냄 (HTML, JSON, XML 등)
8. 클아이언트는 전달받은 응답을 통해서 유저에게 화면을 보여줌 

### Node의 라이프사이클 및 이벤트 루프

1. node app.js 실행 
2. 스크립트가 시작되어 Node.js가 파일 전체를 살펴봄
3. 코드 분석후 변수와 함수를 등록 (코드를 읽고 실행을 시작)
4. 이벤트 루프 실행

이벤트 루프

- Node.js에서 중요한 개념.
- 작업이 남아 있는 한 계속해서 작동하는 루프 프로세스로 이벤트 리스너가 있는 한 계속 작동
- createServer 함수가 이벤트 리스너 함수다.
- 코어 노드 애플리케이션은 이 이벤트 노드에 의해 관리됨.
- Node.js는 서버관리를 포함해 다양한 방면에서 이벤트 드리븐 접근 방법임. (js는 단일 스레드로 실행하기 때문)
- 여러 요청이 들어올 때 마다 멈추고 실행하기를 반복하지 않을 수 있는것이, 이벤트 루프 개념을 통해 계속해서 작동되면서 이벤트가 일어나면 코드를 실행하도록 함으로써 언제나 사용 가능한 것임.
- 배후에서는 운영 체제의 영향력에 따라 약간의 다중 스레드를 사용하긴 한다.

### 요청 본문 분석

Streams

- 들어온 요청에 대한 데이터는 데이터 스트림으로 보내진다.
- 스트림은 지속적인 프로세스이다.
- 노드가 많은 양의 요청의 한 청크씩 읽으면서 기다리지 않으면서 여러 요청을 동시에 처리한다. (스트림 방식을 통해)
- 간단한 요청은 위 과정없이 금방 끝나겠지만, 업로드 파일의 경우에는 상당히 오래 걸리게 될 것 이다.
    - 이 때 데이터 스트리밍을 하면 디스크에 쓸 수 있다.
    - 즉, 데이터가 들어오는 와중에 앱이 실행되는 하드 드라이버나 노드 앱이 실행되는 서버에 쓸 수 있다.
    - 그래서 파일 전체가 분석 완료되고 전부 업로드 되기까지 아무것도 안하면서 기다릴 필요가 없다.

Buffers

- 코드를 사용해 청크를 마음대로 다룰 수는 없고, 대신에 들어오는 청크를 체계화하기 위해 버퍼를 이용한다.
- 버퍼는 버스 정류장과 비슷한데, 버스는 항상 달리지만 사용자나 승객이 버스에 타고 내릴 수 있으려면 버스 정류장이 있는데, 이것이 바로 버퍼의 역할이다.
- 여러 개의 청크를 보유하고 파싱이 끝나기 전에 작업할 수 있도록 해준다.
- req.on 메서드를 통해 이벤트 리스너를 등록하면 사용할 수 있다.

### 이벤트 기반 코드 실행의 이해

- Node.js는 함수를 함수 안에 넣으면, 안에 넣은 함수를 나중에 실행하는데 이거를 비동기식이라고 부른다.
- Node.js가 해당 함수를 바로 실행하지 않고, 내부적으로 이벤트 리스너를 하나 추가한다.

### Node.js 백그라운드 확인

Single Thread, Event Loop & Blocking Code

- Node.js는 코드에 대해 하나의 js 스레드만 사용
- 이벤트 루프는 Node.js가 시작되면 프로그램에 의해 자동으로 시작된다.
- 이벤트 루프는 이벤트 콜백을 다룬다. (createServer, req.on 등)
    - 단, 파일 연산 등은 다루지 않는다.
    - 완성된 쓰기 파일에 정의한 콜백에 대한 코드들만 처리한다. (이런 코드는 금방 처리 가능)
    - 즉, 이벤트 루프는 빨리 끝낼 수 있는 코드를 포함한 콜백만을 다룬다.
- 오래 걸리는 연산은 워커풀에 보내진다.
    - Node.js가 자동으로 시작하고 관리한다.
    - js 코드로부터 완전히 분리되어 다른 여러 스레드에서 작동할 수 있으며 앱을 실행하는 운영체제와 깊은 연관이 있다.
    - 워커풀의 워커가 코드, 요청 및 이벤트 루프와 분리된 상태에서 작업을 수행한다.
    - 이벤트 루프와는 한가지 연결점이 있는데, 워커가 파일 읽기 등의 작업을 마치면 읽기 파일 연산에 대한 콜백이 시작되는데 이벤트 루프가 콜백을 책임지기 떄문에 결국 이벤트 루프에 들어가게 된다.